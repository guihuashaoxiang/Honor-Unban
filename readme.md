# 王者荣耀“蓄意战败”答题脚本 - 雅典娜精神永不认输

> 我，雅典娜玩家，绝不认输！没人比我们更想赢。面对“蓄意战败”禁赛的答题以及不平等条约，我选择用代码无脑答题！

**编写此代码纯属也是为了玩，我只进行了答题，未签不平等条约！！！**
视频评论区说签不平等条约后，扣分更狠，我就当这是我的未成年保护了，禁赛就上线，不给日活，休息，舒服~~~未求证

应粉丝及评论区要求，放出代码：[B站视频地址](https://www.bilibili.com/video/BV1TFGAzPEWc)

> **注意**
> 当前代码未经测试，之前旧版本代码测试把答题直接过了，现在为优化后代码没有测试的了，有问题Issue留言反馈，或者提供账号测试我给你答题。

---

## 声明

**本项目仅供学习和技术交流使用，请勿用于任何商业或非法用途。滥用自动化工具可能违反游戏的用户协议，使用者需自行承担一切风险。**

玩游戏也是玩，写代码也是玩。本项目旨在探索如何用 Python 实现桌面自动化，解决一些重复性问题，顺便不服不合理的系统蓄意战败禁赛机制。

## 项目介绍

这是一个基于 `pyautogui` 和 `paddleocr` 的简单暴力答题脚本，旨在自动完成王者荣耀中的“蓄意战败”答题环节，帮助被系统误判的玩家（尤其是我们伟大的雅典娜玩家）无脑答题解禁。

脚本通过不断尝试所有可能的答案组合，直到题目刷新到下一题为止，从而“猜”出正确答案，并将其记录下来，为未来构建题库打下基础。

等我下次禁赛就可以构建题库，或者提供禁赛账号让我调试，从而以后快速答题。

## 功能特性

- **暴力破解**：自动遍历单选题和多选题的所有答案组合。
- **跨平台兼容**：
  - 支持**手机投屏到电脑**进行操作（通过模拟拖拽滚动）。
  - 支持在**电脑端微信小程序**中直接运行（通过模拟鼠标滚轮滚动）。
  - 默认模式 (`BOTH`) 会同时尝试两种滚动方式，兼容性极强。
- **智能识别**：使用 PaddleOCR 识别题号和题目类型（单选/多选）。
- **自动化截图**：为每个题目自动截图，如果需要滚动，还会额外截取滚动后的图像，方便复查和调试。
- **答案记录**：每次成功解答后，自动将题号和正确答案记录在 `solution_map.json` 文件中，为构建题库提供数据。
- **日志与回溯**：每次运行都会生成带时间戳的独立日志文件和截图文件夹，便于追踪和分析每次运行的过程。

## 环境准备

在运行脚本之前，请确保你已经安装了所有必要的 Python 库。

1.  **安装 Python**: 建议使用 Python 3.8 或更高版本。
2.  **安装依赖库**:
    推荐创建一个 `requirements.txt` 文件，将以下内容复制进去，然后通过一行命令安装所有依赖。

    **`requirements.txt` 文件内容:**
    ```txt
    pyautogui
    opencv-python
    paddleocr
    paddlepaddle
    airtest
    numpy
    ```

    在你的终端（或命令提示符）中，使用 `cd` 命令进入项目根目录，然后运行：
    ```bash
    pip install -r requirements.txt
    ```
    **或者**，你也可以手动逐一安装：
    ```bash
    pip install pyautogui opencv-python paddleocr paddlepaddle airtest numpy
    ```
    > **注意**: `paddleocr` 可能会需要一些额外的系统依赖，请根据其官方文档进行安装。通常，先安装 `paddlepaddle` 再安装 `paddleocr` 可以解决大部分问题。

## 如何使用

### 第一步：获取答题区域坐标

你需要告诉脚本你的答题界面在屏幕的哪个位置。

1.  打开你的答题界面（无论是手机投屏还是微信小程序）。
2.  运行项目中的 `get_region_tool.py` 脚本。
    ```bash
    python get_region_tool.py
    ```
3.  根据脚本提示，依次将鼠标移动到答题区域的**左上角**和**右下角**，并按下回车键。
4.  脚本会生成一行类似 `SCREEN_REGION = (123, 456, 789, 1011)` 的代码。**复制这行代码**。

### 第二步：配置主脚本

打开主脚本 `auto_solver.py`，找到顶部的全局配置区域。

1.  **粘贴区域坐标**：将上一步复制的 `SCREEN_REGION = ...` 代码粘贴到配置区，替换掉原来的那一行。
2.  **配置滚动模式**: 根据你的使用场景，修改 `SCROLL_MODE` 的值。
    -   `SCROLL_MODE = 'MOBILE_DRAG'`: 如果你的答题界面是**手机投屏**，且无法用鼠标滚轮滚动。
    -   `SCROLL_MODE = 'PC_WHEEL'`: 如果你的答题界面是**电脑微信小程序**或其它PC原生应用。
    -   `SCROLL_MODE = 'BOTH'`: **（默认值）** 不确定或想两边都兼容，就用这个。
3.  **(可选) 调整运行速度与延时**:
    如果脚本运行太快导致点击失败，或者运行太慢影响效率，你可以调整以下几个延时参数（单位：秒）：
    -   `FIXED_POST_SUBMIT_DELAY = 1`: 点击“提交”按钮后，等待下一题加载的固定时间。如果你的网络或设备较慢，可以适当增加此值，例如 `2`。
    -   `POST_TOUCH_DELAY = 0.8`: 每次点击选项按钮后的等待时间。通常无需修改，除非界面响应特别慢。
    -   `POST_SCROLL_DELAY = 1.5`: 每次滚动页面后的等待时间，确保页面元素加载完毕。如果滚动后找不到按钮，可以尝试增加此值。

### 第三步：准备模板图片

脚本需要模板图片来识别选项按钮（A, B, C, D）和提交按钮。

1.  确保项目根目录下有一个 `templates` 文件夹。
2.  对你的答题界面的 **A, B, C, D 选项** 和 **提交按钮** 进行截图。
3.  将截图保存到 `templates` 文件夹中，并遵循以下命名规则：
    -   **选项按钮**: `option_A_1.png`, `option_B_1.png`, `option_C_1.png`, `option_D_1.png`。
    -   **提交按钮**: `submit_button.png`。

    > **提示**: 截图越小、越清晰，识别效果越好。只截取按钮本身或其核心特征部分即可。

    > **重要提示：关于选项模板不匹配的问题**
    >
    > 有时，即使你已经截图了 `option_A_1.png`，脚本在运行时仍然可能找不到 A 选项。这通常发生在以下情况：
    >
    > -   **图形题**：选项本身不是一个带“A”字母的按钮，而是一张图片。
    > -   **样式变化**：选项被选中后，其外观（如颜色、边框）会发生改变。
    >
    > **解决方案：**
    >
    > 当脚本提示“未找到任何选项”或卡在某个题目时，你需要为这些**特殊样式**的选项补充模板截图。
    >
    > 1.  找到那个无法识别的选项（例如，是一个图形选项A，或者是一个被选中状态的B选项）。
    > 2.  对它进行截图。
    > 3.  按照 `option_[字母]_[序号].png` 的格式命名并保存到 `templates` 文件夹。序号应递增。
    >
    > **示例：**
    > - 你已经有了 `option_A_1.png`（一个普通的“A”按钮）。
    > - 现在遇到一个图形题，它的“A选项”是一张小兵的图片。你需要截图这张小兵图片，并将其命名为 `option_A_2.png`。
    > - 脚本会自动加载所有同名选项的模板（`option_A_1.png`, `option_A_2.png`...），并逐一尝试匹配。

### 第四步：运行脚本

一切准备就绪！确保你的答题界面在前台且无遮挡。

在终端中运行主脚本：
```bash
python auto_solver.py
```
脚本会有3秒倒计时，之后便会开始自动答题。你可以坐和放宽，欣赏代码的表演。

## 运行产物

每次成功运行后，项目目录下会生成两个新文件夹：

-   `logs/`: 存放日志文件。每个日志文件都以运行开始的时间命名，记录了脚本执行的每一步。
-   `screenshots/`: 存放截图。
    -   里面会有一个以运行时间命名的子文件夹。
    -   该子文件夹内，每个题目都会有至少一张截图，如 `第1题_1.png`。如果需要滚动，还会有 `第1题_2.png`。
    -   当脚本结束时，还会生成一个 `solution_map.json` 文件，记录了所有已解答题目的正确答案。

**`solution_map.json` 文件示例:**
```json
{
    "第1题": [
        "B"
    ],
    "第2题": [
        "A",
        "C"
    ]
}
```

## 常见问题 (FAQ)

**Q: 脚本运行了，但没有点击任何按钮。**
**A:**
1.  **区域坐标错误**: 检查 `SCREEN_REGION` 配置是否正确，确保它完全覆盖了答题区域。
2.  **模板不匹配**: 检查 `templates` 文件夹里的图片是否清晰、命名是否正确。特别是注意**重要提示**中提到的选项样式不一致问题，可能需要补充截图。
3.  **分辨率/缩放问题**: 确保你的屏幕分辨率和缩放比例在运行期间没有改变。

**Q: OCR 识别不出题号。**
**A:**
1.  **界面遮挡**: 确保 `SCREEN_REGION` 区域内没有其它窗口或通知的遮挡。
2.  **字体/背景复杂**: 如果答题界面的字体或背景非常花哨，可能会影响OCR识别。这是 `paddleocr` 的局限性，通常情况下它工作得很好。

**Q: 脚本找到答案后，下一题还是找不到按钮。**
**A:** 可能是页面加载需要时间。在 `auto_solver.py` 的配置区中，尝试适当增加 `FIXED_POST_SUBMIT_DELAY` 的值，例如 `FIXED_POST_SUBMIT_DELAY = 2`。

---
**最后，再次声明：雅典娜玩家永不为奴！除非包吃包住。**